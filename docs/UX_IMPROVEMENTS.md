# Анализ UX и предложения по улучшению структуры приложения

## Текущая структура

### Страницы
1. **index.html** (Главная) — Дашборд активности по пользователям
   - Период выборки
   - Сводка за период
   - Активность по пользователям (карточки/таблица/тепловая карта)
   - Затраты по проектам

2. **team-snapshot.html** (Расходы) — Участники и расходы текущего месяца
   - Team Members API
   - Spending Data API
   - Отдельная страница, требует перехода

3. **invoices.html** (Счета и учёт) — 3 таба
   - Счета (загрузка PDF)
   - Отчёт (анализ счетов)
   - Сверка (reconciliation Invoice vs Usage Events)

4. **settings.html** (Настройки) — 4 таба
   - Загрузка в БД (API key, синхронизация Daily Usage + Usage Events)
   - Данные в БД (просмотр сырых данных)
   - Jira (загрузка CSV пользователей)
   - Аудит (просмотр Audit Events)

### Навигация
```
Главная → Расходы → Счета и учёт → Настройки
```

## Проблемы UX

### 1. Фрагментация источников данных
- **API данные** загружаются в Настройки → Загрузка в БД
- **Jira CSV** загружается в Настройки → Jira
- **Счета PDF** загружаются в отдельном разделе Счета и учёт → Счета
- Пользователю нужно помнить, где какой источник находится

### 2. Разделение дашбордов
- **Активность пользователей** (Daily Usage + Usage Events) на index.html
- **Расходы текущего месяца** (Team Members + Spending) на team-snapshot.html
- Две связанные аналитики разнесены по разным страницам
- После просмотра одного дашборда нужно переходить на другой

### 3. Отсутствие контекстных переходов
- После загрузки данных API нет быстрой ссылки на дашборд
- После загрузки Jira нет перехода на просмотр результата
- После загрузки счета нужно вручную переходить к сверке

### 4. Дублирование информации
- "Покрытие БД" показывается в двух табах: Загрузка в БД и Данные в БД
- Неясная связь между покрытием и актуальностью данных на дашбордах

### 5. Непонятная иерархия
- "Настройки" содержат не только настройки, но и загрузку данных, и просмотр БД
- Название не отражает реальное назначение раздела

## Рекомендации по улучшению

### Вариант 1: Унификация по типу задач (РЕКОМЕНДУЕТСЯ)

Реорганизовать навигацию по функциональным блокам:

#### Новая структура страниц

1. **Дашборд** (index.html) — ЕДИНЫЙ центр аналитики
   - **Период и фильтры** (текущая логика)
   - **Сводка** (объединённая из обеих дашбордов)
   - **Вкладки дашборда:**
     - Активность по пользователям (текущий контент)
     - Расходы текущего месяца (контент из team-snapshot.html)
     - Затраты по проектам
   - **Быстрые действия:**
     - "↻ Обновить данные из API"
     - "⚙ Настроить источники данных"

2. **Данные** (data.html) — Управление источниками данных
   - **Таб: API**
     - API key
     - Загрузка Daily Usage + Usage Events
     - Покрытие БД
     - Кнопка "→ Посмотреть на дашборде"
   - **Таб: Jira**
     - Загрузка CSV пользователей
     - Список загруженных пользователей
     - Кнопка "→ Посмотреть активность пользователей"
   - **Таб: Счета (PDF)**
     - Загрузка счетов
     - Список загруженных счетов
     - Кнопка "→ Перейти к сверке"
   - **Таб: Сырые данные БД**
     - Просмотр аналитики по эндпоинтам
     - Выгрузка в JSON

3. **Учёт** (accounting.html) — Счета и финансы
   - **Таб: Счета**
     - Список счетов с позициями
   - **Таб: Сверка**
     - Reconciliation (Invoice vs Usage Events)
   - **Таб: Отчёты**
     - Финансовые отчёты по счетам

4. **Аудит** (audit.html или в рамках Данные)
   - Audit Events
   - История изменений

#### Навигация
```
Дашборд (по умолчанию) ← → Данные ← → Учёт ← → Аудит
```

#### Преимущества
- ✅ Весь дашборд в одном месте
- ✅ Все источники данных в одном разделе
- ✅ Логическая группировка по задачам
- ✅ Меньше переходов между страницами
- ✅ Контекстные ссылки после загрузки данных

### Вариант 2: Добавление контекстных связей (минимальные изменения)

Если полная реорганизация невозможна, добавить:

1. **После загрузки данных API:**
   ```
   ✓ Данные загружены за период 01.06.2025 - 05.02.2026
   → Посмотреть на дашборде | → Просмотр сырых данных
   ```

2. **После загрузки Jira CSV:**
   ```
   ✓ Загружено 45 пользователей
   → Посмотреть активность пользователей
   ```

3. **После загрузки счёта PDF:**
   ```
   ✓ Счёт загружен: invoice_123.pdf (15 позиций)
   → Перейти к сверке | → Посмотреть отчёт
   ```

4. **На дашборде добавить:**
   - Индикатор актуальности данных (последняя загрузка)
   - Быстрая ссылка "↻ Обновить данные" → Данные / API

5. **В team-snapshot.html:**
   - Интегрировать как iframe в index.html ИЛИ
   - Добавить как вкладку в блоке "Активность по пользователям"

### Вариант 3: Пошаговый мастер загрузки (для новых пользователей)

Добавить стартовую страницу-мастер при первом запуске:

```
Шаг 1: Подключение API
→ Введите API key

Шаг 2: Загрузка данных активности
→ Выберите период и загрузите Daily Usage + Usage Events

Шаг 3: Загрузка пользователей Jira (опционально)
→ Загрузите CSV для отображения имён

Шаг 4: Загрузка счетов (опционально)
→ Загрузите PDF счета для сверки

[Готово! Перейти к дашборду →]
```

## Конкретный план реализации (Вариант 1)

### Этап 1: Объединение дашбордов (высокий приоритет)
1. Добавить в index.html новую вкладку "Расходы текущего месяца"
2. Перенести логику из team-snapshot.html в dashboard.js
3. team-snapshot.html оставить для обратной совместимости с редиректом

### Этап 2: Реорганизация источников данных (средний приоритет)
1. Переименовать settings.html → data.html
2. Переместить таб "Счета" из invoices.html в data.html
3. Обновить навигацию

### Этап 3: Контекстные переходы (средний приоритет)
1. После загрузки API → кнопка "Посмотреть на дашборде"
2. После загрузки Jira → кнопка "Посмотреть активность"
3. После загрузки счёта → кнопка "Перейти к сверке"

### Этап 4: Индикаторы актуальности (низкий приоритет)
1. На дашборде показывать дату последней загрузки данных
2. Предупреждение, если данные устарели (>7 дней)

## Рекомендуемое решение

**Рекомендую реализовать Вариант 1 поэтапно:**

1. **Фаза 1** (быстрые улучшения):
   - Добавить контекстные ссылки после загрузки (Вариант 2)
   - Переименовать "Настройки" → "Управление данными"
   
2. **Фаза 2** (унификация):
   - Объединить дашборды (index.html + team-snapshot.html)
   - Показывать покрытие БД один раз с актуальностью
   
3. **Фаза 3** (оптимизация):
   - Реорганизовать источники данных в единый раздел
   - Добавить индикаторы актуальности

Это минимизирует переключение между разделами и сделает работу с приложением более линейной и логичной.
